<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="by XLJ"><meta name="description" conauthortent="laji OIer"><link rel="alternative" href="/atom.xml" title="XLJ's blog" type="application/atom+xml"><link rel="icon" href="/img/favicon.png"><title>2017.7.28 NOIP模拟 - XLJ's blog</title><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/js/fancybox/jquery.fancybox.min.css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--><script src="/js/jquery-3.1.1.min.js"></script><script src="/js/fancybox/jquery.fancybox.min.js"></script></head><body style="opacity:0;"><header class="head"><h1 class="head-title u-fl"><a href="/">XLJ's blog</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a class="head-nav__link" href="/archives">カタログ（目录）</a></li><li class="head-nav__item"><a class="head-nav__link" href="/about">について（关于）</a></li><li class="head-nav__item"><a class="head-nav__link" href="/L-link">友達（友链）</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"> <time class="post__time" datetime="2017-07-28T07:06:41.515Z">July 28, 2017</time><h1 class="post__title"><a href="/2017/07/28/2017.7.28 NOIP模拟/">2017.7.28 NOIP模拟</a></h1><div class="post__main echo"><p><script><br>    if(“12345678”==prompt(“请输入密码”)) { alert(“正确”); }<br>    else { alert(“错误”); location=”<a href="http://xianglujia.github.io&quot;;}">http://xianglujia.github.io&quot;;}</a><br></script></p>
<h1 id="Streaming-6"><a href="#Streaming-6" class="headerlink" title="Streaming #6"></a>Streaming #6</h1><h2 id="NOIP-模拟赛-Day-2"><a href="#NOIP-模拟赛-Day-2" class="headerlink" title="(NOIP 模拟赛 Day 2)"></a>(NOIP 模拟赛 Day 2)</h2><table>
<thead>
<tr>
<th>题目名称</th>
<th>九九归一</th>
<th>LCA 的统计</th>
<th>四驱兄弟</th>
</tr>
</thead>
<tbody>
<tr>
<td>目录</td>
<td>mulone</td>
<td>lcastat</td>
<td>letsandgo</td>
</tr>
<tr>
<td>可执行文件名</td>
<td>mulone</td>
<td>lcastat</td>
<td>letsandgo</td>
</tr>
<tr>
<td>输入文件名</td>
<td>标准输入</td>
<td>标准输入</td>
<td>标准输入</td>
</tr>
<tr>
<td>输出文件名</td>
<td>标准输出</td>
<td>标准输出</td>
<td>标准输出</td>
</tr>
<tr>
<td>每个测试点时限</td>
<td>1 秒</td>
<td>1 秒</td>
<td>1 秒</td>
</tr>
<tr>
<td>内存限制</td>
<td>128M</td>
<td>128M</td>
<td>128M</td>
</tr>
<tr>
<td>测试点数目</td>
<td>10</td>
<td>10</td>
<td>10</td>
</tr>
<tr>
<td>每个测试点分值</td>
<td>10</td>
<td>10</td>
<td>10</td>
</tr>
<tr>
<td>是否有部分分</td>
<td>无</td>
<td>无</td>
<td>无</td>
</tr>
<tr>
<td>题目类型</td>
<td>传统</td>
<td>传统</td>
<td>传统</td>
</tr>
</tbody>
</table>
<h3 id="答疑帖：http-tieba-baidu-com-p-3330026662"><a href="#答疑帖：http-tieba-baidu-com-p-3330026662" class="headerlink" title="答疑帖：http://tieba.baidu.com/p/3330026662"></a>答疑帖：<a href="http://tieba.baidu.com/p/3330026662" target="_blank" rel="external">http://tieba.baidu.com/p/3330026662</a></h3><p>得分情况与总结：<br>本人分数:170(100+10+60)<br>预想完美分数:260(100+60+100)<br>可是。。<br>第二题LCA倍增打炸一点点（-50）+第三题没开ULL（-40）<br>GG….<br>所以还是同上一篇一样</p>
<h2 id="细节啊！"><a href="#细节啊！" class="headerlink" title="细节啊！"></a>细节啊！</h2><h1 id="九九归一"><a href="#九九归一" class="headerlink" title="九九归一"></a>九九归一</h1><h2 id="【问题描述】"><a href="#【问题描述】" class="headerlink" title="【问题描述】"></a>【问题描述】</h2><p>萌蛋在练习模𝑛意义下的乘法时发现，总有一些数，在自乘若干次以后，会 变成 1。例如𝑛 = 7，那么5 × 5 𝑚𝑜𝑑 7 = 4,4 × 5 𝑚𝑜𝑑 7 = 6,6 × 5 𝑚𝑜𝑑 7 = 2,2 × 5 𝑚𝑜𝑑 7 = 3,3 × 5 𝑚𝑜𝑑 7 = 1。如果继续乘下去，就会陷入循环当中。 萌蛋还发现，这个循环的长度经常会是φ(𝑛)，即小于𝑛且与𝑛互质的正整数 的个数。例如，φ(7) = 6，而上述循环的长度也是 6，因为 5,4,6,2,3,1 共有 6 个 数。 再如𝑛 = 6，那么5 × 5 𝑚𝑜𝑑 6 = 1。这个循环的长度很短，只有 2，而恰好 φ(6) = 2。 然而，对于某些情况，虽然循环的长度可以是φ(𝑛)，但存在比φ(𝑛)更小的长 度：例如𝑛 = 7，而2 × 2 𝑚𝑜𝑑 7 = 4,4 × 2 𝑚𝑜𝑑 7 = 1，循环的长度只有 3。当然， 6 也可以是一个循环的长度。 假设已知了𝑛，我们称数𝑎神奇的，当且仅当关于数𝑎的循环长度可以是φ(𝑛)， 而且不存在比φ(𝑛)更小长度的循环。例如对于𝑛 = 7，5 是神奇的，而 2 不是神 奇的。 现在给出𝑛和𝑞次询问，每次询问给出𝑎，问𝑎是否是神奇的。 </p>
<h2 id="【输入文件】"><a href="#【输入文件】" class="headerlink" title="【输入文件】"></a>【输入文件】</h2><p>第一行两个整数𝑜 𝑟。<br>第二行有𝑟个整数，每个表示一个𝑎。</p>
<h2 id="【输出文件】"><a href="#【输出文件】" class="headerlink" title="【输出文件】"></a>【输出文件】</h2><p>输出𝑟个字符，1 表示这个数是神奇的 神奇的，0 表示这个数不是 神奇的 的。</p>
<h2 id="【输入样例】"><a href="#【输入样例】" class="headerlink" title="【输入样例】"></a>【输入样例】</h2><p>7 3<br>5 2 0</p>
<h2 id="【输出样例】"><a href="#【输出样例】" class="headerlink" title="【输出样例】"></a>【输出样例】</h2><p>100</p>
<h2 id="【数据规模和约定】"><a href="#【数据规模和约定】" class="headerlink" title="【数据规模和约定】"></a>【数据规模和约定】</h2><p>对于30%的数据，n≤ 1000，对于 60%的数据，n ≤ 100,000。<br>80%的数据，n ≤ 1,000,000。<br>对于 100%的数据，n ≤ 10,000,000,q ≤ 100,000,0 ≤ 𝑎 &lt; n。</p>
<h2 id="【题解】"><a href="#【题解】" class="headerlink" title="【题解】"></a>【题解】</h2><p>昨天**阳竟然在不知道这题的情况下告诉我了这题的做法。。！<br>首先看a^φ(𝑛)是不是等于1（mod n）<br>不是就直接输出0<br>是的就继续判断 对于d（是n的约数）<br>如果满足a^d也是1<br>那么就输出0（循环节更小）<br>求φ(𝑛)用线性筛</p>
<h2 id="【代码】"><a href="#【代码】" class="headerlink" title="【代码】"></a>【代码】</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N  10000000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long </span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> phi[<span class="number">10000005</span>];</div><div class="line"><span class="keyword">int</span> prime[<span class="number">10000005</span>];</div><div class="line"><span class="keyword">int</span> flag[<span class="number">10000005</span>];</div><div class="line"><span class="keyword">int</span> gys[<span class="number">1000005</span>];</div><div class="line"><span class="keyword">int</span> n,q,ans,pos;</div><div class="line"><span class="keyword">int</span> fai;</div><div class="line"><span class="keyword">namespace</span> DO&#123;</div><div class="line">	<span class="function">ll <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">		ll rtn=<span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=y;i;i&gt;&gt;=<span class="number">1</span>,x=<span class="number">1l</span>l*x*x%n)</div><div class="line">			<span class="keyword">if</span>(i&amp;<span class="number">1</span>) rtn=(rtn*<span class="number">1l</span>l*x)%n;</div><div class="line">		<span class="keyword">return</span> rtn%n;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">pre</span><span class="params">()</span></span>&#123;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">if</span>(!flag[i])&#123;</div><div class="line">				prime[++ans]=i;</div><div class="line">				phi[i]=i<span class="number">-1</span>;</div><div class="line">			&#125; </div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=ans;j++)&#123;</div><div class="line">				<span class="keyword">int</span> to=prime[j]*i;</div><div class="line">				<span class="keyword">if</span>(to&gt;n) <span class="keyword">break</span>;</div><div class="line">				flag[to]=<span class="number">1</span>;</div><div class="line">				<span class="keyword">if</span>(i%prime[j]==<span class="number">0</span>) &#123;</div><div class="line">					phi[to]=phi[i]*prime[j];<span class="keyword">break</span>;</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">else</span> &#123;</div><div class="line">	                    	phi[to]=phi[i]*(prime[j]<span class="number">-1</span>);</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">		<span class="keyword">if</span>(ksm(x,fai)!=<span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=pos;i++)&#123;</div><div class="line">			<span class="keyword">if</span>(ksm(x,gys[i])==<span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	freopen(<span class="string">"mulone.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">	freopen(<span class="string">"mulone.out"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</div><div class="line">	<span class="comment">//printf("%d",(sizeof(phi)*3+sizeof(gys))/1024/1024);</span></div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;q);</div><div class="line">	DO::pre();</div><div class="line">	fai=phi[n];</div><div class="line">	<span class="comment">//printf("%d",fai);</span></div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;fai;i++)&#123;</div><div class="line">		<span class="keyword">if</span>(fai%i==<span class="number">0</span>) </div><div class="line">			gys[++pos]=i;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> x;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=q;i++)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x);</div><div class="line">		<span class="keyword">if</span>(DO::solve(x))</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"1"</span>);</div><div class="line">		<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"0"</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="LCA-的统计"><a href="#LCA-的统计" class="headerlink" title="LCA 的统计"></a>LCA 的统计</h1><h2 id="【问题描述】-1"><a href="#【问题描述】-1" class="headerlink" title="【问题描述】"></a>【问题描述】</h2><p>萌蛋有一棵𝑛个节点的有根树，其根节点为 1。除此之外，节点𝑖的父节点 为𝑝𝑖。每个点上都有一个权值，节点𝑖的权值是𝑤𝑖。 萌蛋知道你一定知道什么叫做祖先（从根到某个点的路径上的每个点都是 这个点的祖先，包括它本身），也一定知道什么叫做最近公共祖先（两个点的最 近公共祖先是某个点，这个点同时是两个点的祖先，且离根最远）。 现在给出这棵树，你需要求出： </p>
<p><img src="http://latex.codecogs.com/gif.latex?\dpi{200}&space;\small&space;\sum_{i=1}^{n}\sum_{j=1}^{n}w_iw_jw_{lca(i,j" alt="image">})</p>
<p>其中𝐿𝐶𝐴(𝑖,𝑗)表示点𝑖与点𝑗的最近公共祖先。 由于答案可能很大，你只需要输出它对 1,000,000,007 取模的结果。 </p>
<h2 id="【输入文件】-1"><a href="#【输入文件】-1" class="headerlink" title="【输入文件】"></a>【输入文件】</h2><p>第一行为两个整数𝑛 𝑤1。 第二行到第𝑛行，第𝑖行有两个整数𝑝𝑖 𝑤𝑖。 </p>
<h2 id="【输出文件】-1"><a href="#【输出文件】-1" class="headerlink" title="【输出文件】"></a>【输出文件】</h2><p> 输出只有一行，为一个整数，表示所求答案对 1,000,000,007 取模的结果。 </p>
<h2 id="【输入样例】-1"><a href="#【输入样例】-1" class="headerlink" title="【输入样例】"></a>【输入样例】</h2><p>2 2 1 1<br>【输出样例】<br>17 </p>
<h2 id="【样例解释】"><a href="#【样例解释】" class="headerlink" title="【样例解释】"></a>【样例解释】</h2><p>1 × 1 × 1 + 1 × 2 × 2 + 2 × 1 × 2 + 2 × 2 × 2 = 17。 </p>
<h2 id="【数据规模和约定】-1"><a href="#【数据规模和约定】-1" class="headerlink" title="【数据规模和约定】"></a>【数据规模和约定】</h2><p>对于 30%的数据，𝑛 ≤ 100,𝑤𝑖 ≤ 10。 对于 60%的数据，𝑛 ≤ 1,000,𝑤𝑖 ≤ 1,000。 对于 100%的数据，1 ≤ 𝑛 ≤ 100,000,0 ≤ 𝑤𝑖 ≤ 1,000,000,000,1 ≤ 𝑝𝑖 &lt; 𝑖。 </p>
<h2 id="【题解】-1"><a href="#【题解】-1" class="headerlink" title="【题解】"></a>【题解】</h2><p>• 枚举𝐿𝐶𝐴 𝑖,𝑗 ，快速算出符合条件的𝑖的权值和与𝑗的权值和的乘积，更新答案。<br>• 第一种情况是𝑖和𝑗分布在𝐿𝐶𝐴 𝑖,𝑗 的不同子节点的子树中，设𝐿𝐶𝐴 𝑖,𝑗 的所有子节点的 权值和依次为𝑆1,𝑆2,…,𝑆𝑘，那么这部分的答案就是 𝑖 𝑗≠𝑖 𝑆𝑖𝑆𝑗。设𝐴 = 𝑖 𝑆𝑖，那么这 部分的答案就是 𝑖 𝑆𝑖 𝐴 − 𝐴𝑖 。化为这种形式就可以线性计算了<br>• 第二种情况是𝑖和𝑗有一个就是𝐿𝐶𝐴 𝑖,𝑗 ，那么这部分的答案就是2𝐴𝑤𝐿𝐶𝐴 𝑖,𝑗<br>• 第三种情况是𝑖和𝑗都是𝐿𝐶𝐴 𝑖,𝑗 ，这部分的答案就是𝑤𝐿𝐶𝐴 𝑖,𝑗 2。<br>• 将以上三种情况求和就是答案。</p>
<p>此题我只拿了60的暴力。。<br>具体实现看注释</p>
<h4 id="配一个图"><a href="#配一个图" class="headerlink" title="配一个图"></a>配一个图</h4><p><img src="http://ww1.sinaimg.cn/large/0060lm7Tgy1fhzlz6dgq2j30qc0evwff.jpg" alt="image"></p>
<h2 id="【代码】-1"><a href="#【代码】-1" class="headerlink" title="【代码】"></a>【代码】</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long </span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span>  cnt;</div><div class="line"><span class="keyword">const</span> LL mod =<span class="number">1e9</span>+<span class="number">7</span>;</div><div class="line"><span class="keyword">int</span> n;</div><div class="line"><span class="keyword">int</span>  head[<span class="number">2001000</span>];</div><div class="line"><span class="keyword">bool</span> vis[<span class="number">2001000</span>];</div><div class="line">LL w[<span class="number">1001000</span>];</div><div class="line">LL sum[<span class="number">1001000</span>];</div><div class="line">LL ans=<span class="number">0</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></div><div class="line">	<span class="keyword">int</span> to,next;</div><div class="line">&#125;e[<span class="number">2001000</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;	</div><div class="line">	e[++cnt].to=y;e[cnt].next=head[x];head[x]=cnt;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> k)</span></span>&#123;</div><div class="line">	LL rtn=<span class="number">0</span>,tot=<span class="number">0</span>;vis[k]=<span class="literal">true</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=head[k];i;i=e[i].next)&#123;</div><div class="line">		<span class="keyword">int</span> kk=e[i].to;</div><div class="line">		<span class="keyword">if</span>(!vis[kk])&#123;</div><div class="line">			dfs(kk);</div><div class="line">			rtn=(rtn+sum[kk])%mod;<span class="comment">//子树的和</span></div><div class="line">			tot=(tot+sum[kk]*sum[kk]%mod)%mod;<span class="comment">//tot 记录平方和 </span></div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	sum[k]=rtn+w[k];<span class="comment">//记录sum =子树的和+自己 </span></div><div class="line">	</div><div class="line">	ans=(ans+(w[k]*w[k]%mod)*w[k]%mod)%mod;<span class="comment">//i=j=lca(i,j)的时候 </span></div><div class="line">	ans=(ans+((rtn*w[k]%mod)*<span class="number">2</span>)%mod*w[k]%mod)%mod;<span class="comment">//ans的每个子节点都有 a*lca(a,b)*lca(a,b)的结构</span></div><div class="line">	 </div><div class="line">	rtn=(rtn*rtn-tot+mod)*w[k]%mod;<span class="comment">//和的平方减去平方和 </span></div><div class="line">	ans=(ans+rtn)%mod;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	freopen(<span class="string">"lcastat.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">   	freopen(<span class="string">"lcastat.out"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%lld"</span>,&amp;n,&amp;w[<span class="number">1</span>]);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">int</span> x;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%lld"</span>,&amp;x,&amp;w[i]);</div><div class="line">		insert(i,x);</div><div class="line">		insert(x,i); </div><div class="line">	&#125;</div><div class="line">	dfs(<span class="number">1</span>);</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>,ans); </div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="四驱兄弟"><a href="#四驱兄弟" class="headerlink" title="四驱兄弟"></a>四驱兄弟</h1><h2 id="【问题描述】-2"><a href="#【问题描述】-2" class="headerlink" title="【问题描述】"></a>【问题描述】</h2><p>如果你和萌蛋一样，也看过《四驱兄弟》，你或许会记得，有一局比赛十分 特别，只按照 5 个人中的第 4 名计算成绩。 现在我们将问题扩展一下：一共有𝑛个队员，只按照其中的第𝑘名计算成 绩。而赛车的规则也有所不同：一共有𝑚个赛车，每个赛车装配着 2 个 GP 晶 片的终端，且第𝑖个赛车预期到达终点的时间为𝑎𝑖。（注：不同赛车上的终端可 以对应着相同的 GP 晶片，但不会 2 个都相同；任何赛车上的 2 个终端对应的 GP 晶片都是不同的） 比赛开始时，𝑛个队员依次选择自己的赛车。对于每个队员，他可以选择开 启 GP 晶片功能或不开启。如果开启，那么 2 个终端对应的 GP 晶片就会建立连 接，且这个赛车的比赛用时就是预期时间𝑎𝑖；如果不开启，那么 GP 晶片不会 建立连接，但是这个赛车的比赛用时将会非常长（可以认为是无穷）。甚至，他 可以放弃比赛，这样他不会占用任何赛车，但是当然比赛用时也会被认为是无 穷。 任何时候，一旦存在若干个（至少 3 个）晶片 A,B,C,…,X 满足：A 与 B 建 立了连接，B 与 C 建立了连接，……，X 与 A 建立了连接（即形成了循环连接 的情况） ，那么处理系统就会崩溃。这是非常可怕的，我们宁可让比赛用时变为 无穷也不能让系统崩溃。 现在给出队员和赛车的信息，请输出最优情况下的成绩（即第𝑘小的比赛时 间的最小值）。 为了增大难度，𝑘并不是给出的，而是你需要对于1 ≤ 𝑘 ≤ 𝑛的所 有的𝑘输出答案。 </p>
<h2 id="【输入文件】-2"><a href="#【输入文件】-2" class="headerlink" title="【输入文件】"></a>【输入文件】</h2><p>第一行为两个整数𝑛 𝑚。 接下来𝑚行，每行描述了一个赛车，格式为空格隔开的一个整数和两个字符 串，分别是𝑎𝑖和它的两个终端对应的 GP 晶片名。 </p>
<h2 id="【输出文件】-2"><a href="#【输出文件】-2" class="headerlink" title="【输出文件】"></a>【输出文件】</h2><p>𝑛行，每行一个整数，第𝑖行表示𝑖 = 𝑘时的答案。特别地，如果答案是无穷， 输出 INF。 </p>
<h2 id="【输入样例】-2"><a href="#【输入样例】-2" class="headerlink" title="【输入样例】"></a>【输入样例】</h2><p>3 3<br>95 GP_1 GP_2<br>100 GP_1 gp@3<br>100 gp@3 GP_2 </p>
<h2 id="【输出样例】-1"><a href="#【输出样例】-1" class="headerlink" title="【输出样例】"></a>【输出样例】</h2><p>95 100 INF </p>
<h2 id="【样例解释】-1"><a href="#【样例解释】-1" class="headerlink" title="【样例解释】"></a>【样例解释】</h2><p>以下是一种最优方案（方案可能不唯一）： 首先，3 人各自选择了 1 辆赛车。（都没有放弃参赛） 如果𝑘 = 1，那么让赛车 1 开启 GP 晶片，其余不开启，此时 3 个赛车的比赛 时间分别为 95，INF，INF，第 1 名的成绩是 95。 如果𝑘 = 2，那么让赛车 2 和 3 开启 GP 晶片，而赛车 1 不开启，此时 3 个赛 车的比赛时间分别为 100，100，INF，第 2 名的成绩是 100。 如果𝑘 = 3，那么由于 3 辆赛车不可能都开启 GP 晶片（因为假设都开启，那 么 3 个 GP 晶片会出现循环连接的情况，这是不允许的），所以总有赛车没有开 启 GP 晶片，那么第 3 名的成绩一定是 INF。 </p>
<h2 id="【数据规模和约定】-2"><a href="#【数据规模和约定】-2" class="headerlink" title="【数据规模和约定】"></a>【数据规模和约定】</h2><p>对于 20%的数据，𝑛,𝑚 ≤ 3，GP 晶片名称的长度均为 1。 对于 40%的数据，𝑛,𝑚 ≤ 6，GP 晶片名称的长度均为 1。 对于 60%的数据，𝑛,𝑚 ≤ 1,000，GP 晶片的长度不会超过 3。 对于 100%的数据，0 &lt; 𝑛,𝑚 ≤ 100,000，0 &lt; 𝑎𝑖 ≤ 1,000,000,000，GP 晶片 的名称只包含大小写字母、数字、“@” 、“_”共 64 种字符且长度不会超过 5 且非空</p>
<h2 id="【题解】-2"><a href="#【题解】-2" class="headerlink" title="【题解】"></a>【题解】</h2><p>（注：不同赛车上的终端可 以对应着相同的 GP 晶片，但不会 2 个都相同；任何赛车上的 2 个终端对应的 GP 晶片都是不同的）<br>这句话就说明了很多东西<br>因为不让有环，还良心的告诉你没有重复的边！<br>那么这个题就是个很简单的最小生成树了<br>可是这个字符串名字的处理有点烦<br>我还以为只有我一个人用hash+离散化<br>结果发现就是这样用的<br>所以<br>此题就是一个hash+离散化+最小生成树的题<br>离散化数组没开ULL炸40分<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> P 255</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ULL unsigned long long </span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n,m,cnt;</div><div class="line">ULL oa[<span class="number">100050</span>],ob[<span class="number">100050</span>];</div><div class="line">ULL pos[<span class="number">100050</span>];</div><div class="line"><span class="keyword">int</span> fa[<span class="number">100050</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">findf</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> fa[x]==x?x:fa[x]=findf(fa[x]);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">	fa[findf(x)]=findf(y);</div><div class="line">&#125; </div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></div><div class="line">	<span class="keyword">int</span> x,y,w;</div><div class="line">&#125;e[<span class="number">100050</span>];</div><div class="line"><span class="function">ULL <span class="title">hash</span><span class="params">(<span class="keyword">char</span> *s)</span></span>&#123;</div><div class="line"> 	ULL tmp=s[<span class="number">0</span>];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;<span class="built_in">strlen</span>(s);j++)</div><div class="line">            tmp=tmp*P+s[j];</div><div class="line">	<span class="keyword">return</span> tmp;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(edge xx,edge yy)</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> xx.w&lt;yy.w;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	freopen(<span class="string">"letsandgo.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">	freopen(<span class="string">"letsandgo.out"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</div><div class="line">	<span class="comment">//Input</span></div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</div><div class="line">		<span class="keyword">int</span> time;</div><div class="line">		<span class="keyword">char</span> ta[<span class="number">10</span>],tb[<span class="number">10</span>];</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d %s %s"</span>,&amp;e[i].w,&amp;ta,&amp;tb);</div><div class="line">		oa[i]=hash(ta);ob[i]=hash(tb);</div><div class="line">		pos[++cnt]=oa[i];pos[++cnt]=ob[i];</div><div class="line">	&#125;</div><div class="line">	sort(pos+<span class="number">1</span>,pos+<span class="number">1</span>+cnt);</div><div class="line">	<span class="keyword">int</span> tot=<span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=cnt;i++)&#123;</div><div class="line">		<span class="keyword">while</span>(pos[i]==pos[i+<span class="number">1</span>]) i++;</div><div class="line">		pos[++tot]=pos[i];</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</div><div class="line">		e[i].x=lower_bound(pos+<span class="number">1</span>,pos+<span class="number">1</span>+tot,oa[i])-pos;</div><div class="line">		e[i].y=lower_bound(pos+<span class="number">1</span>,pos+<span class="number">1</span>+tot,ob[i])-pos;</div><div class="line">	&#125;	</div><div class="line">	<span class="comment">//end Input</span></div><div class="line">	sort(e+<span class="number">1</span>,e+<span class="number">1</span>+m,cmp);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=tot;i++)</div><div class="line">		fa[i]=i;</div><div class="line">	<span class="keyword">int</span> local_time=<span class="number">0</span>;</div><div class="line">	<span class="keyword">int</span> kk=<span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</div><div class="line">		<span class="keyword">int</span> tx=e[i].x,ty=e[i].y,tw=e[i].w;</div><div class="line">		<span class="keyword">if</span>(findf(tx)!=findf(ty))&#123;</div><div class="line">			merge(tx,ty);</div><div class="line">			local_time++;</div><div class="line">			<span class="keyword">if</span>(local_time==kk)</div><div class="line">				<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,e[i].w);</div><div class="line">			kk++;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(;kk&lt;=n;kk++)&#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"INF\n"</span>);</div><div class="line">	&#125; </div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</div></header><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a class="post__tag__link" href="/tags/NOIP模拟赛/">NOIP模拟赛</a></li></ul></footer></article><section class="reward"> <a class="btn-reward" href="#">加好友 or 打赏</a><div class="reward-wrapper clearfix"><img src="/img/QQ.jpg" title="QQ"><img src="/img/wechat.jpg" title="微信"></div></section><div class="comments" id="lv-container" data-id="city" data-uid="MTAyMC8yOTYwMy82MTcx"><script>(function(d, s) {var j, e = d.getElementsByTagName(s)[0];if (typeof LivereTower === 'function') { return; } j = d.createElement(s);j.src = 'https://cdn-city.livere.com/js/embed.dist.js';j.async = true;e.parentNode.insertBefore(j, e);})(document, 'script');</script></div></main><footer class="foot"><div class="foot-copy">&copy; 2017 by XLJ</div></footer><script src="/js/scroller.js"></script><script src="/js/main.js"></script></body></html>