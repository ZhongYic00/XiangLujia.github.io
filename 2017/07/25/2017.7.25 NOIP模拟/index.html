<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="by XLJ"><meta name="description" conauthortent="laji OIer"><link rel="alternative" href="/atom.xml" title="XLJ's blog" type="application/atom+xml"><link rel="icon" href="/img/favicon.png"><title>2017.7.25 NOIP模拟 - XLJ's blog</title><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/js/fancybox/jquery.fancybox.min.css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--><script src="/js/jquery-3.1.1.min.js"></script><script src="/js/fancybox/jquery.fancybox.min.js"></script></head><body style="opacity:0;"><header class="head"><h1 class="head-title u-fl"><a href="/">XLJ's blog</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a class="head-nav__link" href="/archives">カタログ（目录）</a></li><li class="head-nav__item"><a class="head-nav__link" href="/about">について（关于）</a></li><li class="head-nav__item"><a class="head-nav__link" href="/L-link">友達（友链）</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"> <time class="post__time" datetime="2017-07-25T08:03:44.032Z">July 25, 2017</time><h1 class="post__title"><a href="/2017/07/25/2017.7.25 NOIP模拟/">2017.7.25 NOIP模拟</a></h1><div class="post__main echo"><script>
    if("233"==prompt("Please input password"))
    {

    }
    else
    {
        alert("Wrong");
        location="https://xianglujia.github.io";
    }
</script>

<table>
<thead>
<tr>
<th>中文题目名称</th>
<th>拆地毯</th>
<th>还教室</th>
<th>皇后游戏 </th>
</tr>
</thead>
<tbody>
<tr>
<td>英文题目名称</td>
<td>carpet</td>
<td>classroom</td>
<td>game </td>
</tr>
<tr>
<td>输入文件名</td>
<td></td>
<td>标准输入（键盘）</td>
<td></td>
</tr>
<tr>
<td>输出文件名</td>
<td></td>
<td>标准输出（屏幕）</td>
<td></td>
</tr>
<tr>
<td>每个测试点时限</td>
<td>1 秒</td>
<td>1 秒</td>
<td>1 秒</td>
</tr>
<tr>
<td>内存限制</td>
<td>512MB</td>
<td>512MB</td>
<td>512MB </td>
</tr>
<tr>
<td>测试点数目</td>
<td>10</td>
<td>20</td>
<td>20 </td>
</tr>
<tr>
<td>每个测试点分值</td>
<td>10</td>
<td>5</td>
<td>5 </td>
</tr>
<tr>
<td>是否有部分分</td>
<td>否</td>
<td>否</td>
<td>否 </td>
</tr>
<tr>
<td>题目类型</td>
<td>传统型</td>
<td>传统型</td>
<td>传统型 </td>
</tr>
</tbody>
</table>
<p>注意：最终测试时，将开启-O2 优化开关。</p>
<p>得分情况与总结：<br>本人分数:60(0+50+10)<br>第一题sort写掉爆零<br>二三题还是因为自己太弱<br>注意看数据范围啊！！！<br>要多多练习啊！！</p>
<h1 id="拆地毯"><a href="#拆地毯" class="headerlink" title="拆地毯"></a>拆地毯</h1><h2 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h2><p>还记得 NOIP 2011 提高组 Day1 中的铺地毯吗？时光飞逝，光阴荏苒，三年 过去了。组织者精心准备的颁奖典礼早已结束，留下的则是被人们踩过的地毯。 请你来解决类似于铺地毯的另一个问题。 </p>
<h2 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h2><p>会场上有 n 个关键区域，不同的关键区域由 m 条无向地毯彼此连接。每条 地毯可由三个整数 u、v、w 表示，其中 u 和 v 为地毯连接的两个关键区域编号， w 为这条地毯的美丽度。 由于颁奖典礼已经结束，铺过的地毯不得不拆除。为 了贯彻勤俭节约的原则， 组织者被要求只能保留 K 条地毯，且保留的地毯构成的图中，任意可互相到达 的两点间只能有一种方式互相到达。换言之，组织者要求新图中不能有环。现在 组织者求助你，想请你帮忙算出这 K 条地毯的美丽度之和最大为多少。 </p>
<h2 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式"></a>输入格式</h2><p>第一行包含三个正整数 n、m、K。 接下来 m 行中每行包含三个正整数 u、v、w。 </p>
<h2 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h2><p>只包含一个正整数，表示这 K 条地毯的美丽度之和的最大值。 </p>
<h2 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h2><p>5 4 3<br>1 2 10<br>1 3 9<br>2 3 7<br>4 5 3 </p>
<h2 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h2><p>22 </p>
<h2 id="样例说明"><a href="#样例说明" class="headerlink" title="样例说明"></a>样例说明</h2><p>选择第 1、2、4 条地毯，美丽度之和为 10 + 9 + 3 = 22。 若选择第 1、2、3 条地毯，虽然美丽度之和可以达到 10 + 9 + 7 = 26，但这 将导致关键区域 1、2、3 构成一个环，这是题目中不允许的。<br>【数据规模与约定】<br>所有测试点的数据规模如下：<br><img src="https://thumbnail0.baidupcs.com/thumbnail/602188122c9e7dcad8b871be8cc3fd96?fid=3376044848-250528-438125876625120&amp;time=1500962400&amp;rt=sh&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-eflN%2FyWsceARj2HHTdQEbQ4ksA0%3D&amp;expires=8h&amp;chkv=0&amp;chkbd=0&amp;chkpc=&amp;dp-logid=4768239905905310350&amp;dp-callid=0&amp;size=c710_u400&amp;quality=100&amp;vuk=-&amp;ft=video" alt="image"><br>对于全部测试数据满足 1 ≤ K ≤ n-1，1 ≤ u≠v ≤ n，1 ≤ w ≤ 1,000。保证至 少存在一种方案使得在原图中可以选出 K 条边，这 K 条边构成的新图无环。</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>大水题啊，一眼题<br>最大生成树（和地毯有什么关系吗？？？）<br>可是我写了cmp忘了sort<br>于是爆炸0分<br><del>(mmp)</del><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> fa[<span class="number">200050</span>];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></div><div class="line">	<span class="keyword">int</span> x,y,w;</div><div class="line">&#125;a[<span class="number">200500</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">findf</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> x==fa[x]?x:fa[x]=findf(fa[x]);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">	fa[findf(x)]=findf(y);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(node xx,node yy)</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> xx.w&gt;yy.w;</div><div class="line">&#125; </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	freopen(<span class="string">"carpet.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">	freopen(<span class="string">"carpet.oput"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</div><div class="line">	<span class="keyword">int</span> n,m,k;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;n,&amp;m,&amp;k);</div><div class="line">	<span class="keyword">int</span> x,y,w;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;a[i].x,&amp;a[i].y,&amp;a[i].w);</div><div class="line">	k=min(k,n<span class="number">-1</span>);</div><div class="line">	sort(a+<span class="number">1</span>,a+<span class="number">1</span>+m,cmp);	</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">		fa[i]=i;</div><div class="line">	<span class="keyword">int</span> cnt=<span class="number">0</span>,ans=<span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</div><div class="line">		<span class="keyword">int</span> tx=a[i].x;<span class="keyword">int</span> ty=a[i].y;<span class="keyword">int</span> tw=a[i].w;</div><div class="line">		<span class="keyword">if</span>(findf(tx)!=findf(ty))&#123;</div><div class="line">			merge(tx,ty);</div><div class="line">			ans+=tw;</div><div class="line">			cnt++;</div><div class="line">			<span class="keyword">if</span>(cnt==k)</div><div class="line">			<span class="keyword">break</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>,ans);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="还教室"><a href="#还教室" class="headerlink" title="还教室"></a>还教室</h1><h2 id="引子-1"><a href="#引子-1" class="headerlink" title="引子"></a>引子</h2><p>还记得 NOIP 2012 提高组 Day2 中的借教室吗？时光飞逝，光阴荏苒，两年 过去了，曾经借教室的同学们纷纷归还自己当初租借的教室。请你来解决类似于 借教室的另一个问题。 </p>
<h2 id="问题描述-1"><a href="#问题描述-1" class="headerlink" title="问题描述"></a>问题描述</h2><p>在接受借教室请求的 n 天中，第 i 天剩余的教室为 ai个。作为大学借教室服 务的负责人，你需要完成如下三种操作共 m 次： ① 第 l 天到第 r 天，每天被归还 d 个教室。 ② 询问第 l 天到第 r 天教室个数的平均数。 ③ 询问第 l 天到第 r 天教室个数的方差。 </p>
<h2 id="输入格式-1"><a href="#输入格式-1" class="headerlink" title="输入格式"></a>输入格式</h2><p>第一行包括两个正整数 n 和 m，其中 n 为借教室的天数，m 为操作次数。 接下来一行，共 包含 n 个整数，第 i 个整数表示第 i 天剩余教室数目为 ai个。 接下来 m 行，每行的第一个整数为操作编号（只能为 1 或 2 或 3），接下来 包含两个正整数 l 和 r，若操作编号为 1，则接下来再包含一个正整数 d。 </p>
<h2 id="输出格式-1"><a href="#输出格式-1" class="headerlink" title="输出格式"></a>输出格式</h2><p>对于每个操作 2 和操作 3，输出一个既约分数（分子与分母互质）表示询问 的答案（详见样例）。 若 答 案 为 0 ， 请 输出“0/1”（不含引号）。 </p>
<h2 id="样例输入-1"><a href="#样例输入-1" class="headerlink" title="样例输入"></a>样例输入</h2><p>5 4<br>1 2 3 4 5<br>1 1 2 3<br>2 2 4<br>3 2 4<br>3 1 5 </p>
<h2 id="样例输出-1"><a href="#样例输出-1" class="headerlink" title="样例输出"></a>样例输出</h2><p>4/1<br>2/3<br>14/25 </p>
<h2 id="数据规模与约定"><a href="#数据规模与约定" class="headerlink" title="数据规模与约定"></a>数据规模与约定</h2><p>所有测试点的数据规模如下： </p>
<p><img src="https://thumbnail0.baidupcs.com/thumbnail/0d249a036637aed38d171ba81c032a0f?fid=3376044848-250528-66385442026709&amp;time=1500962400&amp;rt=sh&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-GlfkSxMgoGSuDWeiVDoMWYUR6ac%3D&amp;expires=8h&amp;chkv=0&amp;chkbd=0&amp;chkpc=&amp;dp-logid=4768414778982743226&amp;dp-callid=0&amp;size=c710_u400&amp;quality=100&amp;vuk=-&amp;ft=video" alt="image"></p>
<p>对于全部测试数据满足：1 ≤ l ≤ r ≤ n，0 ≤ ai ≤ 10，1 ≤ d ≤ 3，操作 1 的数量 不超过 10%。<br>注意：ai和 d 的范围很小及操作1数量很少的原因是为了保证答案的分子不会很大，以防止答案的分子溢出 64 位整数的范围，这与题目做法无关。 </p>
<h2 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h2><p>和原来NOIP的题目终于有一点关系了<br>写法还是线段树<br>不过因为要求方差<br>把式子拆开各种化简<br><img src="http://latex.codecogs.com/gif.latex?%5Cdpi%7B200%7D%20%5Csmall%20FangCha%3D%5Cfrac%7B1%7D%7Bn%7D*%28x_1&plus;x_2&plus;x_3&plus;....x_n%29&plus;%28%5Coverline%7Bx%7D%29%5E2" alt="image"></p>
<p>所以维护一个平方和<br><img src="https://latex.codecogs.com/gif.latex?%5Csum_%7Bi%3Dl%7D%5E%7Br%7D%28x_i&plus;dx%29%5E%7B2%7D%3D%5Csum_%7Bi%3Dl%7D%5E%7Br%7Dx_i%5E%7B2%7D&plus;2*x_i*dx&plus;dx%5E%7B2%7D" alt="image"><br>数学方法推公式啊就行了。。<br>(我怎么考的时候不会维护平方和呢！！)<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100500 </span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ls p&lt;&lt;1</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> rs p&lt;&lt;1|1 </span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long </span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> t[N];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></div><div class="line">	<span class="keyword">int</span> l,r;</div><div class="line">	ll sum,addv;</div><div class="line">	ll sum_2;</div><div class="line">&#125;a[N*<span class="number">4</span>];</div><div class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll x,ll y)</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> y?gcd(y,x%y):x;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</div><div class="line">	a[p].l=l;a[p].r=r;</div><div class="line">	<span class="keyword">if</span>(l==r)&#123;</div><div class="line">		a[p].sum=t[l];</div><div class="line">		a[p].sum_2=t[l]*t[l];</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> mid=(l+r)/<span class="number">2</span>;</div><div class="line">	build(p&lt;&lt;<span class="number">1</span>,l,mid);</div><div class="line">	build(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r);</div><div class="line">	a[p].sum=a[p&lt;&lt;<span class="number">1</span>].sum+a[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].sum;</div><div class="line">	a[p].sum_2=a[p&lt;&lt;<span class="number">1</span>].sum_2+a[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].sum_2;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(a[p].addv!=<span class="number">0</span>)&#123;</div><div class="line">		<span class="keyword">int</span> tp=a[p].addv;</div><div class="line">		a[ls].addv+=a[p].addv;a[rs].addv+=a[p].addv;</div><div class="line">		a[ls].sum_2+=tp*tp*(a[ls].r-a[ls].l+<span class="number">1</span>)+<span class="number">2</span>*tp*a[ls].sum ;</div><div class="line">		a[rs].sum_2+=tp*tp*(a[rs].r-a[rs].l+<span class="number">1</span>)+<span class="number">2</span>*tp*a[rs].sum ;</div><div class="line">		a[ls].sum+=a[p].addv*(a[ls].r-a[ls].l+<span class="number">1</span>);</div><div class="line">		a[rs].sum+=a[p].addv*(a[rs].r-a[rs].l+<span class="number">1</span>);</div><div class="line">		a[p].addv=<span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</div><div class="line">	a[p].sum=a[ls].sum+a[rs].sum; </div><div class="line">	a[p].sum_2=a[ls].sum_2+a[rs].sum_2;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> v)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(a[p].l==x&amp;&amp;a[p].r==y)</div><div class="line">	&#123;</div><div class="line">		a[p].sum_2+=(a[p].r-a[p].l+<span class="number">1</span>)*v*v+<span class="number">2</span>*v*(a[p].sum);</div><div class="line">		a[p].sum+=(a[p].r-a[p].l+<span class="number">1</span>)*v;</div><div class="line">		a[p].addv+=v;</div><div class="line">		<span class="keyword">return</span>; </div><div class="line">	&#125;</div><div class="line">	pushdown(p);</div><div class="line">	<span class="keyword">int</span> mid=(a[p].l+a[p].r)/<span class="number">2</span>;</div><div class="line">	<span class="keyword">if</span>(y&lt;=mid)</div><div class="line">		update(ls,x,y,v);</div><div class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(x&gt;mid)</div><div class="line">		update(rs,x,y,v);</div><div class="line">	<span class="keyword">else</span> </div><div class="line">	&#123;</div><div class="line">		update(ls,x,mid,v);</div><div class="line">		update(rs,mid+<span class="number">1</span>,y,v);</div><div class="line">	&#125;</div><div class="line">	pushup(p);</div><div class="line">&#125;</div><div class="line"><span class="function">ll <span class="title">query</span><span class="params">(<span class="keyword">int</span> p,ll x,ll y)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(a[p].l==x&amp;&amp;a[p].r==y)</div><div class="line">		<span class="keyword">return</span> a[p].sum;</div><div class="line">	pushdown(p);</div><div class="line">	<span class="keyword">int</span> mid=(a[p].l+a[p].r)/<span class="number">2</span>;</div><div class="line">	<span class="keyword">if</span>(y&lt;=mid)	<span class="keyword">return</span> query(ls,x,y);</div><div class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(x&gt;mid) <span class="keyword">return</span> query(rs,x,y);</div><div class="line">	<span class="keyword">else</span> <span class="keyword">return</span> query(ls,x,mid)+query(rs,mid+<span class="number">1</span>,y); </div><div class="line">&#125;</div><div class="line"><span class="function">ll <span class="title">query_2</span><span class="params">(<span class="keyword">int</span> p,ll x,ll y)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(a[p].l==x&amp;&amp;a[p].r==y)</div><div class="line">		<span class="keyword">return</span> a[p].sum_2;</div><div class="line">	pushdown(p);</div><div class="line">	<span class="keyword">int</span> mid=(a[p].l+a[p].r)/<span class="number">2</span>;</div><div class="line">	<span class="keyword">if</span>(y&lt;=mid)	<span class="keyword">return</span> query_2(ls,x,y);</div><div class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(x&gt;mid) <span class="keyword">return</span> query_2(rs,x,y);</div><div class="line">	<span class="keyword">else</span> <span class="keyword">return</span> query_2(ls,x,mid)+query_2(rs,mid+<span class="number">1</span>,y); </div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">	ll q=gcd(x,y);</div><div class="line">	x/=q;y/=q;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%lld/%lld\n"</span>,x,y);</div><div class="line">&#125; </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(ll l,ll r)</span></span>&#123;</div><div class="line">	ll x=query(<span class="number">1</span>,l,r);</div><div class="line">	ll y=r-l+<span class="number">1</span>; </div><div class="line">	print(x,y);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	freopen(<span class="string">"classroom.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">	freopen(<span class="string">"classroom.out"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</div><div class="line">	<span class="keyword">int</span> n,m;</div><div class="line">	<span class="comment">//printf("%d",biggcd(3,15)); </span></div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t[i]); </div><div class="line">	build(<span class="number">1</span>,<span class="number">1</span>,n);</div><div class="line">	<span class="keyword">int</span> k,a,b,c;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</div><div class="line">	&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;k);</div><div class="line">		<span class="keyword">if</span>(k==<span class="number">1</span>)&#123;</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;a,&amp;b,&amp;c);</div><div class="line">			update(<span class="number">1</span>,a,b,c);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(k==<span class="number">2</span>)&#123;</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;a,&amp;b);</div><div class="line">			solve(a,b);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(k==<span class="number">3</span>)&#123;</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;a,&amp;b);</div><div class="line">			ll x1=query(<span class="number">1</span>,a,b);</div><div class="line">			ll x2=query_2(<span class="number">1</span>,a,b);</div><div class="line">			ll len=b-a+<span class="number">1</span>;</div><div class="line">			ll as=x2*len-x1*x1;</div><div class="line">			ll am=len*len;</div><div class="line">				ll k=gcd(am,as);</div><div class="line">				am/=k;as/=k;</div><div class="line">				<span class="built_in">printf</span>(<span class="string">"%lld/%lld\n"</span>,as,am);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="comment">//printf("%d",query(1,1,3));</span></div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="皇后游戏"><a href="#皇后游戏" class="headerlink" title="皇后游戏"></a>皇后游戏</h1><h2 id="引子-2"><a href="#引子-2" class="headerlink" title="引子"></a>引子</h2><p>还记得 NOIP 2012 提高组 Day1 的国王游戏吗？时光飞逝，光阴荏苒，两年 过去了。国王游戏早已过时，如今已被皇后游戏取代，请你来解决类似于国王游 戏的另一个问题。 </p>
<h2 id="问题描述-2"><a href="#问题描述-2" class="headerlink" title="问题描述"></a>问题描述</h2><p>皇后有 n 位大臣，每位大臣的左右手上面分别写上了一个正整数。恰逢国庆 节来临，皇后决定为 n 位大臣颁发奖金，其中第 i 位大臣所获得的奖金数目为第 i－1 位大臣所获得奖金数目与前 i 位大臣左手上的数的和的较大值再加上第 i 位 大臣右手上的数。 形式化地讲：我们设第 i 位大臣左手上的正整数为 ai，右手上的正整数为 bi， 则第 i 位大臣获得的奖金数目为 ci可以表达为：<br><img src="https://thumbnail0.baidupcs.com/thumbnail/6e5b9cb82ec2a2575d422afbdc7a6e4e?fid=3376044848-250528-1080827319429034&amp;time=1500962400&amp;rt=sh&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-ji2hLMCxPV4P6Yomr0ixNeOmLJ8%3D&amp;expires=8h&amp;chkv=0&amp;chkbd=0&amp;chkpc=&amp;dp-logid=4768323478522785363&amp;dp-callid=0&amp;size=c710_u400&amp;quality=100&amp;vuk=-&amp;ft=video" alt="image"></p>
<p>当然，吝啬的皇后并不希望太多的奖金被发给大臣，所以她想请你来重新安 排一下队伍的顺序，使得获得奖金最多的大臣，所获奖金数目尽可能的少。 注意：重新安排队伍并不意味着一定要打乱顺序，我们允许不改变任何一 位大臣的位置。 </p>
<h2 id="输入格式-2"><a href="#输入格式-2" class="headerlink" title="输入格式"></a>输入格式</h2><p>第一行包含一个正整数 T，表示测试数据的组数。 接下来 T 个部分，每个部分的第一行包含一个正整数 n，表示大臣的数目。<br> 每个部分接下来 n 行中，每 行 两个正整数，分 别 为 a i 和 b i ，含 义 如 上文所述。 </p>
<h2 id="输出格式-2"><a href="#输出格式-2" class="headerlink" title="输出格式"></a>输出格式</h2><p>共 T 行，每行包含一个整数，表示获得奖金最多的大臣所获得的奖金数目。</p>
<h2 id="样例输入-1"><a href="#样例输入-1" class="headerlink" title="样例输入 1"></a>样例输入 1</h2><p>1<br>3<br>4 1<br>2 2<br>1 2 </p>
<h2 id="样例输出-1"><a href="#样例输出-1" class="headerlink" title="样例输出 1"></a>样例输出 1</h2><p>8 </p>
<h2 id="样例说明-1"><a href="#样例说明-1" class="headerlink" title="样例说明 1"></a>样例说明 1</h2><p>按照 1、2、3 这样排列队伍，获得最多奖金的大臣获得奖金的数目为 10；  按照 1、3、2 这样排列队伍，获得最多奖金的大臣获得奖金的数目为 9； 按照 2、1、3 这样排列队伍，获得最多奖金的大臣获得奖金的数目为 9； 按照 2、3、1 这样排列队伍，获得最多奖金的大臣获得奖金的数目为 8； 按照 3、1、2 这样排列队伍，获得最多奖金的大臣获得奖金的数目为 9； 按照 3、2、1 这样排列队伍，获得最多奖金的大臣获得奖金的数目为 8。 当按照 3、2、1 这样排列队伍时，三位大臣左右手的数分别为： (1, 2)、(2, 2)、(4, 1) 第 1 位大臣获得的奖金为 1 + 2 = 3； 第 2 位大臣获得的奖金为 max{3, 3} + 2 = 5； 第 3 为大臣获得的奖金为 max{5, 7} + 1 = 8。 </p>
<h2 id="样例输入-2"><a href="#样例输入-2" class="headerlink" title="样例输入 2"></a>样例输入 2</h2><p>2<br>5<br>85 100<br>95 99<br>76 87<br>60 97<br>79 85<br>12<br>9 68<br>18 45<br>52 61<br>39 83<br>63 67<br>45 99<br>52 54<br>82 100<br>23 54<br>99 94<br>63 100<br>52 68 </p>
<h2 id="样例输出-2"><a href="#样例输出-2" class="headerlink" title="样例输出 2"></a>样例输出 2</h2><p>528<br>902 </p>
<h2 id="数据规模与约定-1"><a href="#数据规模与约定-1" class="headerlink" title="数据规模与约定"></a>数据规模与约定</h2><p><img src="https://thumbnail0.baidupcs.com/thumbnail/0f020503af2d426fc53d941721e0c87c?fid=3376044848-250528-942135520941111&amp;time=1500962400&amp;rt=sh&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-a8Sm3Dy2%2FPhyaSnvCcbQwiS1EvM%3D&amp;expires=8h&amp;chkv=0&amp;chkbd=0&amp;chkpc=&amp;dp-logid=4768217641612998419&amp;dp-callid=0&amp;size=c710_u400&amp;quality=100&amp;vuk=-&amp;ft=video" alt="image"></p>
<h2 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h2><p>既然和国王游戏有关联<br>那么就是选出一种策略最优<br>想到国王游戏的高精度<br>于是 我。。<br>二话不说 调了一个小时的高精度！！！<br>听说不用高精度心都碎了<br>一个LL完事</p>
<p>此题最关键的是以什么顺序来排序<br>开始的时候觉得按照国王游戏的左手乘右手的值最小排序<br>带到样例里面过了<br>于是。。10分（还不如暴力）</p>
<p>正解的策略是这样的<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(node xx,node yy)</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> max(xx.x+xx.y+yy.y,xx.x+yy.x+yy.y)&lt;max(yy.x+yy.y+xx.y,xx.x+yy.x+xx.y);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>看似复杂其实不难</p>
<p>设前一个大臣的左右为ax，bx<br>后一个ay，by<br>显然后一个人的钱数大于等于前一个人的钱<br>那么就是要使最一个人的钱少</p>
<p>看这个图就行了（画的有点丑）<br><img src="http://images2015.cnblogs.com/blog/1172999/201707/1172999-20170725160219318-1300613186.png" alt="image"><br>所以代码很简单<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long </span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line">ll sum[<span class="number">100010</span>],c[<span class="number">100010</span>];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></div><div class="line">	ll x,y;</div><div class="line">&#125;a[<span class="number">100010</span>];</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(node xx,node yy)</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> max(xx.x+xx.y+yy.y,xx.x+yy.x+yy.y)&lt;max(yy.x+yy.y+xx.y,xx.x+yy.x+xx.y);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> T;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</div><div class="line">	<span class="keyword">while</span>(T--)&#123;</div><div class="line">		<span class="keyword">int</span> n;</div><div class="line">		<span class="built_in">memset</span>(sum,<span class="number">0</span>,<span class="keyword">sizeof</span>(sum));</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>,&amp;a[i].x,&amp;a[i].y);</div><div class="line">		sort(a+<span class="number">1</span>,a+<span class="number">1</span>+n,cmp);</div><div class="line">		c[<span class="number">1</span>]=a[<span class="number">1</span>].x+a[<span class="number">1</span>].y;</div><div class="line">		sum[<span class="number">1</span>]=a[<span class="number">1</span>].x;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</div><div class="line">		&#123;</div><div class="line">			sum[i]=sum[i<span class="number">-1</span>]+a[i].x;</div><div class="line">			c[i]=max(sum[i],c[i<span class="number">-1</span>])+a[i].y;</div><div class="line">		&#125;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,c[n]);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</div></header><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a class="post__tag__link" href="/tags/NOIP模拟赛/">NOIP模拟赛</a></li></ul></footer></article><section class="reward"> <a class="btn-reward" href="#">加好友 or 打赏</a><div class="reward-wrapper clearfix"><img src="/img/QQ.jpg" title="QQ"><img src="/img/wechat.jpg" title="微信"></div></section><div class="comments" id="lv-container" data-id="city" data-uid="MTAyMC8yOTYwMy82MTcx"><script>(function(d, s) {var j, e = d.getElementsByTagName(s)[0];if (typeof LivereTower === 'function') { return; } j = d.createElement(s);j.src = 'https://cdn-city.livere.com/js/embed.dist.js';j.async = true;e.parentNode.insertBefore(j, e);})(document, 'script');</script></div></main><footer class="foot"><div class="foot-copy">&copy; 2017 by XLJ<a href="https://xianglujia.github.io/about/" target="view_window" style="color:#666;"> Welcome! </a></div></footer><script src="/js/scroller.js"></script><script src="/js/main.js"></script></body></html>