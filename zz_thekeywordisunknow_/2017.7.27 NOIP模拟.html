<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="by XLJ"><meta name="description" conauthortent="laji OIer"><link rel="alternative" href="/atom.xml" title="XLJ's blog" type="application/atom+xml"><link rel="icon" href="/img/favicon.png"><title>2017.7.27 NOIP模拟 - XLJ's blog</title><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/js/fancybox/jquery.fancybox.min.css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--><script src="/js/jquery-3.1.1.min.js"></script><script src="/js/fancybox/jquery.fancybox.min.js"></script></head><body style="opacity:0;"><header class="head"><h1 class="head-title u-fl"><a href="/">XLJ's blog</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a class="head-nav__link" href="/archives">カタログ（目录）</a></li><li class="head-nav__item"><a class="head-nav__link" href="/about">について（关于）</a></li><li class="head-nav__item"><a class="head-nav__link" href="/L-link">友達（友链）</a></li><li class="head-nav__item"><a class="head-nav__link" href="/need_password">パスワード</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"> <time class="post__time" datetime="2017-08-15T15:43:45.637Z">August 15, 2017</time><h1 class="post__title"><a href="/zz_thekeywordisunknow_/2017.7.27 NOIP模拟.html">2017.7.27 NOIP模拟</a></h1><div class="post__main echo"><p>Streaming #5<br>(NOIP 模拟赛 Day 1)</p>
<table>
<thead>
<tr>
<th>题目名称</th>
<th>珠</th>
<th>免农</th>
<th>高维网络</th>
</tr>
</thead>
<tbody>
<tr>
<td>目录</td>
<td>beads</td>
<td>rabit</td>
<td>cube</td>
</tr>
<tr>
<td>可执行文件名</td>
<td>beads</td>
<td>rabit</td>
<td>cube</td>
</tr>
<tr>
<td>输入文件名</td>
<td>标准输入</td>
<td>标准输入</td>
<td>标准输入</td>
</tr>
<tr>
<td>输出文件名</td>
<td>标准输出</td>
<td>标准输出</td>
<td>标准输出</td>
</tr>
<tr>
<td>每个测试点时限</td>
<td>1 秒</td>
<td>1 秒</td>
<td>1 秒</td>
</tr>
<tr>
<td>内存限制</td>
<td>128M</td>
<td>128M</td>
<td>128M</td>
</tr>
<tr>
<td>测试点数目</td>
<td>10</td>
<td>10</td>
<td>10</td>
</tr>
<tr>
<td>每个测试点分值</td>
<td>10</td>
<td>10</td>
<td>10</td>
</tr>
<tr>
<td>是否有部分分</td>
<td>无</td>
<td>无</td>
<td>无</td>
</tr>
<tr>
<td>题目类型</td>
<td>传统</td>
<td>传统</td>
<td>传统</td>
</tr>
</tbody>
</table>
<h3 id="答疑-题解：http-tieba-baidu-com-p-3297669984"><a href="#答疑-题解：http-tieba-baidu-com-p-3297669984" class="headerlink" title="答疑/题解：http://tieba.baidu.com/p/3297669984"></a>答疑/题解：<a href="http://tieba.baidu.com/p/3297669984" target="_blank" rel="external">http://tieba.baidu.com/p/3297669984</a></h3><p>得分情况与总结：<br>本人分数:190(100+40+50)<br>虽然后来加了几句话就多了好多分(日常被吊打)<br>但是，还是要注意细节啊<br>特别是</p>
<h3 id="开long-long！开-long-long"><a href="#开long-long！开-long-long" class="headerlink" title="开long long！开 long long!"></a>开long long！开 long long!</h3><h1 id="珠"><a href="#珠" class="headerlink" title="珠"></a>珠</h1><h2 id="【问题描述】"><a href="#【问题描述】" class="headerlink" title="【问题描述】"></a>【问题描述】</h2><p>萌蛋有𝑛颗珠子，每一颗珠子都写有一个数字。萌蛋把它们用线串成了环。<br>我们称一个数字串是 有趣的 的，当且仅当它的第 1 位是 2，且除了第 1 位以外<br>的每一位都是 3。例如，2，233，2333333 都是 有趣的数字串。<br>现在，你可以从这串珠子的任意一颗开始读，沿着顺时针或逆时针方向，到<br>任意一颗珠子停止。这样，你就可以读出一个数字串来。<br>萌蛋想知道，所有能读出的 有趣 的数字串当中，最长的是哪一个数字串。当<br>然，你也可能读不出任何一个 有趣的数字串，你也需要对这种情况做出判断。</p>
<h2 id="【输入文件】"><a href="#【输入文件】" class="headerlink" title="【输入文件】"></a>【输入文件】</h2><p>输入只有一行，是一个数字串。这是从这串珠子的某一颗开始，顺时针读取<br>恰好一圈得到的。</p>
<h2 id="【输出文件】"><a href="#【输出文件】" class="headerlink" title="【输出文件】"></a>【输出文件】</h2><p>输出只有一行，是能读出的最长 有趣的数字串。特殊地，如果找不到任何 有<br>趣的 的数字串，应输出“TvT”（不含引号）。</p>
<h2 id="【输入样例-1】"><a href="#【输入样例-1】" class="headerlink" title="【输入样例 1】"></a>【输入样例 1】</h2><p>323</p>
<h2 id="【输出样例-1】"><a href="#【输出样例-1】" class="headerlink" title="【输出样例 1】"></a>【输出样例 1】</h2><p>233</p>
<h2 id="【输入样例-2】"><a href="#【输入样例-2】" class="headerlink" title="【输入样例 2】"></a>【输入样例 2】</h2><p>333</p>
<h2 id="【输出样例-2】"><a href="#【输出样例-2】" class="headerlink" title="【输出样例 2】"></a>【输出样例 2】</h2><p>TvT</p>
<h2 id="【数据规模和约定】"><a href="#【数据规模和约定】" class="headerlink" title="【数据规模和约定】"></a>【数据规模和约定】</h2><p>23。<br>400。<br>对于 60%的数据，𝑛 ≤ 1,000。<br>另有 20%的数据，输入的数字串中不含 3。<br>对于 100%的数据，𝑛 ≤ 100,000</p>
<h2 id="【题解】"><a href="#【题解】" class="headerlink" title="【题解】"></a>【题解】</h2><p>第一眼看以为复杂度N^2<br>但是其实想一想是N<br>所以大水题，不多说<br>因为可以顺时针和逆时针<br>所以正着扫一遍，反着扫一遍<br>我考试的时候没看到逆时针<br>结果竟然A了。。。(数据好水啊啊啊)<br>下面是没有写逆时针的代码(QwQ)</p>
<h2 id="【代码】"><a href="#【代码】" class="headerlink" title="【代码】"></a>【代码】</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">char</span> s[<span class="number">200500</span>];<span class="keyword">int</span> len;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	</div><div class="line">	freopen(<span class="string">"beads.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">	freopen(<span class="string">"beads.out"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</div><div class="line">	 </div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%s"</span>,s+<span class="number">1</span>);</div><div class="line">	len=<span class="built_in">strlen</span>(s+<span class="number">1</span>);</div><div class="line">	</div><div class="line">	<span class="keyword">bool</span> check=<span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=len;i++)&#123;</div><div class="line">		<span class="keyword">if</span>(s[i]==<span class="string">'2'</span>)&#123;</div><div class="line">			check=<span class="number">1</span>;<span class="keyword">break</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(!check)</div><div class="line">	&#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"TvT"</span>);</div><div class="line">		<span class="keyword">return</span> <span class="number">0</span>;		</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="keyword">bool</span> flag=<span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=len;i++)&#123;</div><div class="line">		<span class="keyword">if</span>(s[i]==<span class="string">'3'</span>)&#123;</div><div class="line">			flag=<span class="number">1</span>;<span class="keyword">break</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(!flag&amp;&amp;check)&#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"2"</span>);</div><div class="line">		<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=len;i++)</div><div class="line">		s[len+i]=s[i]; </div><div class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>; </div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=len;i++)&#123;</div><div class="line">		<span class="keyword">if</span>(s[i]!=<span class="string">'2'</span>) <span class="keyword">continue</span>;</div><div class="line">		<span class="keyword">int</span> tmp=<span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;=i+len<span class="number">-1</span>;j++)&#123;</div><div class="line">			<span class="keyword">if</span>(s[j]!=<span class="string">'3'</span>) <span class="keyword">break</span>;</div><div class="line">			<span class="keyword">else</span> tmp++;</div><div class="line">		&#125; </div><div class="line">		ans=max(ans,tmp);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(ans==<span class="number">0</span>)</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"2"</span>);</div><div class="line">	<span class="keyword">else</span> </div><div class="line">	&#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"2"</span>);</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=ans;i++)</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"3"</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="免农"><a href="#免农" class="headerlink" title="免农"></a>免农</h1><h2 id="【问题描述】-1"><a href="#【问题描述】-1" class="headerlink" title="【问题描述】"></a>【问题描述】</h2><p>（如果你想更好地理解本题，请先阅读 NOI2011 第一试“兔农”一题）<br>萌蛋近年收入不景气，正在她发愁如何能多赚点钱时，她听到隔壁的小朋友<br>在讨论免子繁殖的问题。（注：免子是一种简单的单细胞生物）<br>问题是这样的：时刻 0 有 2 只刚出生的免子。每一时刻，每只免子都会分裂<br>成为 2 只免子。问时刻𝑛共有多少只免子？<br>聪明的你可能已经发现，时刻𝑛的免子数正好是第𝑛 + 1个 2 的幂次。萌蛋不<br>懂什么叫幂，但她也发现了规律：时刻𝑛 + 1的免子数等于时刻𝑛的免子数的 2 倍。<br>前几个时刻（从 0 开始）的免子数依次为：<br>2 4 8 16 32 64 128 256 512 …<br>萌蛋发现越到后面免子数增长的越快，期待养免子一定能赚大钱，于是萌蛋<br>在时刻 0 买了 2 只免子开始培养。<br>每天，萌蛋都要给免子们提供营养。免子的培养基非常特别，每𝑙只免子占<br>据一个培养基，最后剩下的不足𝑙只占据一个培养基。由于免子特别害怕孤独，<br>如果某个培养基只有 1 只免子，这只免子就会很快死掉。<br>然而，每个时刻的免子数仍然是可以计算的。例如，当𝑙 = 7时，前几个时<br>刻（从 0 开始）的免子数依次为：<br>2 4 7 14 28 56 112 224 448 …<br>给定𝑛，你能帮助萌蛋计算时刻𝑛她有多少只免子么？由于答案可能非常大，<br>你只需要告诉萌蛋时刻𝑛的免子只数对𝑝的余数即可。</p>
<h2 id="【输入文件】-1"><a href="#【输入文件】-1" class="headerlink" title="【输入文件】"></a>【输入文件】</h2><p>输入只有一行，包含三个整数𝑛 𝑙 𝑝。</p>
<h2 id="【输出文件】-1"><a href="#【输出文件】-1" class="headerlink" title="【输出文件】"></a>【输出文件】</h2><p>输出只有一行，为一个整数，表示时刻𝑛的免子只数对𝑝的余数。</p>
<h2 id="【输入样例】"><a href="#【输入样例】" class="headerlink" title="【输入样例】"></a>【输入样例】</h2><p>6 7 10086</p>
<h2 id="【输出样例】"><a href="#【输出样例】" class="headerlink" title="【输出样例】"></a>【输出样例】</h2><p>112</p>
<h2 id="【数据规模和约定】-1"><a href="#【数据规模和约定】-1" class="headerlink" title="【数据规模和约定】"></a>【数据规模和约定】</h2><p>对于 𝑛 ≤ 1,000,000。<br>另有 30%的数据，𝑙是𝑝的正整数倍。<br>对于 100%的数据，𝑛 ≤ 1,000,000,000,2 ≤ 𝑙 ≤ 1,000,000,1 ≤ 𝑝 ≤ 1,000,000。 </p>
<h2 id="【题解】-1"><a href="#【题解】-1" class="headerlink" title="【题解】"></a>【题解】</h2><p>没有看错<br>这题叫<strong>免(mian)农</strong><br>2333<br>仔细想一想这个题，会发现<br>前面是2的某次方<br>只要死了一个免子<br>后面的都是2的某次方*死免子时候的数<br>那么问题变成了</p>
<p><strong>找第一个死免(mian)子的时候</strong><br>怎么做呢<br>我考试的时候不知道怎么取模，就直接暴力枚举到了第2的64次方，结果是40分</p>
<p>后来转念一想，发现<strong>模k</strong>就行了啊<br>这样就可以枚举n个啊<br>我怎么这么蠢！！</p>
<p>特别注意 如果k是偶数，那么是不会死免子的<br>所以特判一下<br>如果k是偶数，输出2的n+1次方</p>
<p>这样的话 我考试交的40分可以变成80分！！</p>
<p>同组的 **阳 用什么欧拉函数和φ值算<br>a^φ(p)=1(mod p)<br>真的是zei行</p>
<h2 id="【代码】-1"><a href="#【代码】-1" class="headerlink" title="【代码】"></a>【代码】</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> LL unsigned long long</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n,k,p;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> ans=<span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=y;i;i&gt;&gt;=<span class="number">1</span>,x=((<span class="number">1l</span>l*x*x)%p))</div><div class="line">		<span class="keyword">if</span>(i&amp;<span class="number">1</span>) ans=(<span class="number">1l</span>l*ans*x)%p;</div><div class="line">	<span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	freopen(<span class="string">"rabit.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">	freopen(<span class="string">"rabit.out"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;n,&amp;k,&amp;p);</div><div class="line">	<span class="keyword">if</span>(k%<span class="number">2</span>==<span class="number">0</span>)&#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d"</span>,ksm(<span class="number">2</span>,n+<span class="number">1</span>));</div><div class="line">		<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> pos=<span class="number">0</span>;</div><div class="line">	n+=<span class="number">1</span>;</div><div class="line">	LL Pow=<span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">	&#123;</div><div class="line">		Pow=(Pow*<span class="number">2</span>)%k;</div><div class="line">		<span class="keyword">if</span>(Pow==<span class="number">1</span>)&#123;</div><div class="line">			pos=i;<span class="keyword">break</span>;</div><div class="line">		&#125; </div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(pos&gt;=<span class="number">1</span>)</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d"</span>,((<span class="number">1l</span>l*ksm(<span class="number">2</span>,pos)<span class="number">-1</span>+p)%p*(ksm(<span class="number">2</span>,n-pos))%p)%p);</div><div class="line">	<span class="keyword">else</span> </div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d"</span>,ksm(<span class="number">2</span>,n)%p);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="高维-网络"><a href="#高维-网络" class="headerlink" title="高维 网络"></a>高维 网络</h1><h2 id="【问题描述】-2"><a href="#【问题描述】-2" class="headerlink" title="【问题描述】"></a>【问题描述】</h2><p>现在有一个𝑑维的坐标网格，其中第𝑗维坐标的范围是[0,𝑎 𝑗 ]。<br>在这个范围内建立一个有向图：我们把范围内的每个整点（每一维坐标均为<br>整数的点）当做图上的顶点。设点𝐵(0,0,⋯,0),𝐶(𝑎 1 ,𝑎 2 ,⋯,𝑎 𝑑 )。<br>对于范围内的点(𝑥 1 ,𝑥 2 ,⋯,𝑥 𝑑 )，它会向以下这些点（如果目标点在范围内）：<br>(𝑥<br>1 + 1,𝑥 2 ,⋯,𝑥 𝑑 ),(𝑥 1 ,𝑥 2 + 1,⋯,𝑥 𝑑 ),⋯,(𝑥 1 ,𝑥 2 ,⋯,𝑥 𝑑 + 1)连有向边。<br>现在从点𝐵到点𝐶会有若干条路径，路径的条数可以十分简单地算出。然而<br>不幸的是，范围内有𝑝个点被破坏了（点𝐵和点𝐶不会被破坏），其中第𝑗个点的坐<br>标为(𝑥 𝑗,1 ,𝑥 𝑗,2 ,⋯,𝑥 𝑗,𝑑 )。你需要算出从点𝐵到点𝐶剩余的路径条数。<br>由于答案可能很大，你只需要输出它对1,000,000,007取模的结果。</p>
<h2 id="【输入文件】-2"><a href="#【输入文件】-2" class="headerlink" title="【输入文件】"></a>【输入文件】</h2><p>第一两个整数𝑑 𝑝。<br>第二行为𝑑个整数，其中第𝑗个数是𝑎 𝑗 。<br>接下来𝑝行，每行𝑑个整数，其中第𝑗行第𝑘个数是𝑥 𝑗,𝑘 。</p>
<h2 id="【输出文件】-2"><a href="#【输出文件】-2" class="headerlink" title="【输出文件】"></a>【输出文件】</h2><p>一个整数，表示从点𝐵到点𝐶剩余的路径条数对1,000,000,007取模的结果。</p>
<h2 id="【输入样例】-1"><a href="#【输入样例】-1" class="headerlink" title="【输入样例】"></a>【输入样例】</h2><p>2 1<br>2 1<br>1 0</p>
<h2 id="【输出样例】-1"><a href="#【输出样例】-1" class="headerlink" title="【输出样例】"></a>【输出样例】</h2><p>1</p>
<h2 id="【样例解释】"><a href="#【样例解释】" class="headerlink" title="【样例解释】"></a>【样例解释】</h2><p>如图所示，当删掉点(1,0)后，从点𝐵到点𝐶的 3 条路径只剩下了 1 条。<br><img src="http://ww3.sinaimg.cn/large/0060lm7Tgy1fhyh6mqdjoj309r05a3yh.jpg" alt="image"></p>
<h2 id="【数据规模和约定】-2"><a href="#【数据规模和约定】-2" class="headerlink" title="【数据规模和约定】"></a>【数据规模和约定】</h2><p><img src="http://ww1.sinaimg.cn/large/0060lm7Tgy1fhyh7nd9dpj30it0hnwfe.jpg" alt="image"></p>
<h2 id="【题解】-2"><a href="#【题解】-2" class="headerlink" title="【题解】"></a>【题解】</h2><h2 id="【非正解】（下面有正解）"><a href="#【非正解】（下面有正解）" class="headerlink" title="【非正解】（下面有正解）"></a>【非正解】（下面有正解）</h2><p>啊，最后一题啊<br>我肯定不会做的啦<br>第一看看上去觉得这题要用很多很高级的方法<br>于是决定打暴力<br>于是看范围<br>咦，很好混分啊<br>首先 d=1的时候直接判断+输出就行<br><strong>可以过1,7两点：10分</strong></p>
<p>d=2的时候 就是dp裸题（类似过河卒）<br>因为最多开1000乘1000<br><strong>所以这样可以过2，3，4，8，9，10 ：40分了</strong></p>
<p>d=3的时候 同上不过是三维<br>最大开 100乘100乘100<br><strong>过掉5，6，11,12于是60分到手</strong></p>
<p>看到p=0的时候<br>我考的时候只会d=2且p=0的情况<br>画图可知道答案为<br>C(min(x,y),x+y)<br>用上递推式+逆元<br>这样过13,14点<br><strong>此时70分到手（美滋滋）</strong></p>
<p>可是没开longlong 炸掉20分（难受）</p>
<p>那么70分代码如下（140行的超级大暴力）<br>Rand()骗运气分（hei~hei~hei)<br><del>虽然没混到</del>（几乎不可能）<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;ctime&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mod 1000000007</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long </span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> f[<span class="number">1005</span>][<span class="number">1005</span>];</div><div class="line"><span class="keyword">int</span> mp[<span class="number">1005</span>][<span class="number">1005</span>];</div><div class="line">ll f2[<span class="number">105</span>][<span class="number">105</span>][<span class="number">105</span>];</div><div class="line"><span class="keyword">int</span> mmp[<span class="number">105</span>][<span class="number">105</span>][<span class="number">105</span>];</div><div class="line">ll C[<span class="number">50050</span>];</div><div class="line"><span class="keyword">int</span> ex,ey,s1,s2,s3;</div><div class="line"><span class="keyword">int</span> d,p;</div><div class="line"><span class="comment">//a[i]=a[i-1]*(n-i+1)/i;</span></div><div class="line"><span class="function">ll <span class="title">ksm</span><span class="params">(ll a,ll b)</span></span>&#123;</div><div class="line">	ll ans=<span class="number">1</span>;</div><div class="line">	<span class="keyword">while</span>(b)&#123;</div><div class="line">		<span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans=(ans*a)%mod;</div><div class="line">		a=(a*a)%mod;</div><div class="line">		b&gt;&gt;=<span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ans%mod;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">inv</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> ksm((ll)x,mod<span class="number">-2</span>);</div><div class="line">&#125;</div><div class="line"><span class="function">ll <span class="title">getC</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;<span class="comment">//return C(x,y)</span></div><div class="line">	C[<span class="number">0</span>]=<span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=x;i++)&#123;</div><div class="line">		C[i]=(<span class="number">1l</span>l*C[i<span class="number">-1</span>]*(y-i+<span class="number">1</span>)%mod*inv(i))%mod;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> C[x]%mod;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">d_2_1</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> x,y;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=p;i++)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</div><div class="line">		f[x][y]=<span class="number">0</span>; </div><div class="line">		mp[x][y]=<span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=ex;i++)&#123;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=ey;j++)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">if</span>(i==<span class="number">0</span>&amp;&amp;j==<span class="number">0</span>) f[i][j]=<span class="number">1</span>;</div><div class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(i&gt;<span class="number">0</span>&amp;&amp;j&gt;<span class="number">0</span>&amp;&amp;!mp[i][j]) f[i][j]=(f[i<span class="number">-1</span>][j]+f[i][j<span class="number">-1</span>])%mod;</div><div class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(i==<span class="number">0</span>&amp;&amp;!mp[i][j]) f[i][j]=f[i][j<span class="number">-1</span>];</div><div class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(j==<span class="number">0</span>&amp;&amp;!mp[i][j]) f[i][j]=f[i<span class="number">-1</span>][j];</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>,f[ex][ey]%mod);</div><div class="line">	<span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">d_3_1</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> x,y,z;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=p;i++)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z);</div><div class="line">		f2[x][y][z]=<span class="number">0</span>; </div><div class="line">		mmp[x][y][z]=<span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=s1;i++)</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=s2;j++)</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;=s3;k++)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">if</span>(i==<span class="number">0</span>&amp;&amp;j==<span class="number">0</span>&amp;&amp;k==<span class="number">0</span>) f2[i][j][k]=<span class="number">1</span>;</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(!mmp[i][j][k])&#123;</div><div class="line">			<span class="keyword">int</span> T1,T2,T3;</div><div class="line">			T1=max(<span class="number">0</span>,i<span class="number">-1</span>);T2=max(<span class="number">0</span>,j<span class="number">-1</span>);T3=max(<span class="number">0</span>,k<span class="number">-1</span>);</div><div class="line">			f2[i][j][k]=(f2[T1][j][k]+f2[i][T2][k]+f2[i][j][T3])%mod;</div><div class="line">		&#125; </div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%lld"</span>,f2[s1][s2][s3]%mod);</div><div class="line">	<span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">d_2_2</span><span class="params">()</span></span>&#123;</div><div class="line">	ll tmp=getC(min(ex,ey),ex+ey);</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%lld"</span>,tmp);</div><div class="line">	<span class="keyword">return</span> ;</div><div class="line">&#125; </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Rand</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>,rand()*rand()%mod);</div><div class="line">	<span class="keyword">return</span> ;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">d_2</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> Max=<span class="number">0</span>;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;ex,&amp;ey);</div><div class="line">	Max=max(ex,ey);</div><div class="line">	<span class="keyword">if</span>(Max&lt;=<span class="number">1000</span>)</div><div class="line">	&#123;</div><div class="line">		d_2_1();</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span> &#123;</div><div class="line">		<span class="keyword">if</span>(p==<span class="number">0</span>)</div><div class="line">			d_2_2();</div><div class="line">		<span class="keyword">else</span> Rand();</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">&#125; </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">d_3</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> Max=<span class="number">0</span>;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;s1,&amp;s2,&amp;s3);</div><div class="line">	Max=max(s1,max(s2,s3));</div><div class="line">	<span class="keyword">if</span>(Max&lt;=<span class="number">100</span>) &#123;</div><div class="line">		d_3_1();</div><div class="line">		<span class="keyword">return</span> ;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span> &#123;</div><div class="line">		Rand();</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="comment">//freopen("cube.in","r",stdin);</span></div><div class="line">	<span class="comment">//freopen("cube.out","w",stdout);</span></div><div class="line">	srand(time(<span class="literal">NULL</span>));</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;d,&amp;p);</div><div class="line">	<span class="keyword">if</span>(d==<span class="number">1</span>)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">if</span>(p==<span class="number">0</span>)&#123;<span class="built_in">printf</span>(<span class="string">"1\n"</span>);<span class="keyword">return</span> <span class="number">0</span>;&#125;</div><div class="line">		<span class="keyword">else</span> &#123;<span class="built_in">printf</span>(<span class="string">"0\n"</span>);<span class="keyword">return</span> <span class="number">0</span>;&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(d==<span class="number">2</span>)&#123;</div><div class="line">		d_2();</div><div class="line">		<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(d==<span class="number">3</span>)&#123;</div><div class="line">		d_3();</div><div class="line">		<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span> &#123;</div><div class="line">		Rand();</div><div class="line">		<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>; </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>然后<br>题解是这么说p=0的情况的<br><img src="http://ww3.sinaimg.cn/large/0060lm7Tgy1fhyhlw3d1ej30tk04174r.jpg" alt="image"><br><strong>what</strong><br>学过<strong>最基本的组合数学知识</strong>???<br>我当然没有学组合数学<br><del>我感觉我学了个假的组合数学</del><br><strong>于是加一小段话 可以过16,19 ：80分到手</strong><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>(p==<span class="number">0</span>)&#123;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=d;i++)</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;a[i]);</div><div class="line">	ll tmp=<span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=d;i++)</div><div class="line">		tmp+=a[i];</div><div class="line">	<span class="keyword">int</span> xx=getjiecheng(tmp);</div><div class="line">	tmp=<span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=d;i++)</div><div class="line">		tmp=(tmp*getjiecheng(a[i]))%mod;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%lld"</span>,xx*inv(tmp)%mod);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="【正解】"><a href="#【正解】" class="headerlink" title="【正解】"></a>【正解】</h2><p>正解？ 正解！<br>就是dp<br><strong>题目的数据名称都提示了。。</strong><br><strong>出题人：告诉你是dp你也不会！</strong></p>
<blockquote>
<h3 id="dp-x-表示从点A到点x，不经过任何一个被破坏的点的路线条数。-就是要求的答案"><a href="#dp-x-表示从点A到点x，不经过任何一个被破坏的点的路线条数。-就是要求的答案" class="headerlink" title="dp[x] 表示从点A到点x，不经过任何一个被破坏的点的路线条数。(就是要求的答案)"></a>dp[x] 表示从点A到点x，不经过任何一个被破坏的点的路线条数。(就是要求的答案)</h3><h3 id="path-x-y-表示从x到y的所有路线条数（就是忽略被破坏的点能得到的方案数）"><a href="#path-x-y-表示从x到y的所有路线条数（就是忽略被破坏的点能得到的方案数）" class="headerlink" title="path(x,y) 表示从x到y的所有路线条数（就是忽略被破坏的点能得到的方案数）"></a>path(x,y) 表示从x到y的所有路线条数（就是忽略被破坏的点能得到的方案数）</h3><h3 id="显然-path-x-y-可以用刚才说的那个p-0的神奇公式算出来"><a href="#显然-path-x-y-可以用刚才说的那个p-0的神奇公式算出来" class="headerlink" title="显然 path(x,y) 可以用刚才说的那个p=0的神奇公式算出来"></a>显然 path(x,y) 可以用刚才说的那个p=0的神奇公式算出来</h3></blockquote>
<p>我连公式都不会怎么办啊！！！<br>如果知道了这个公式<br>那么就可以推状态转移方程<br><img src="http://latex.codecogs.com/gif.latex?%5Cdpi%7B200%7D%20dp%5Bx%5D%3Dpath%28A%2Cx%29-%5Csum_%7By%7D%5E%7By%21%3Dx%7D%28dp%5By%5D*path%28y%2Cx%29%29" alt="image"></p>
<p>这是个什么意思呢？<br>画个图<br><img src="http://ww4.sinaimg.cn/large/0060lm7Tgy1fhyms9900hj31jk0yeast.jpg" alt="image"></p>
<p>就是从A到B的所有方案数减去不可行的方案数<br>当然，这个图中的C点不只是一个<br>得到<br>上面的方程，记忆化搜索完事！</p>
<p>dp数组只用开一维，记录每个破坏的点和起点终点<br>每次的dp更新都是由它其他dp数组中的得来的</p>
<h2 id="【代码】-2"><a href="#【代码】-2" class="headerlink" title="【代码】"></a>【代码】</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> f(x, y, z) for(int x = (y); x &lt;= (z); ++x)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> g(x, y, z) for(int x = (y); x &lt; (z); ++x)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> h(x, y, z) for(int x = (y); x &gt;= (z); --x)</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MOD = <span class="number">1000000007</span>;</div><div class="line"><span class="keyword">const</span> LL MODLL = <span class="number">1000000007L</span>L;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">pow</span><span class="params">(LL x, <span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">	LL ans = <span class="number">1</span>;</div><div class="line">	h(i, <span class="number">30</span>, <span class="number">0</span>)&#123;</div><div class="line">		ans = ans * ans % MODLL;</div><div class="line">		<span class="keyword">if</span>(y &amp; (<span class="number">1</span> &lt;&lt; i)) ans = ans * x % MODLL;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">inv</span><span class="params">(LL x)</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> <span class="built_in">pow</span>(x, MOD - <span class="number">2</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">LL fac[<span class="number">10000086</span>], invfac[<span class="number">100086</span>], _dp[<span class="number">508</span>];</div><div class="line"><span class="keyword">int</span> d, n, a[<span class="number">108</span>], x[<span class="number">508</span>][<span class="number">108</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">paths</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</div><div class="line">	LL ans = <span class="number">1</span>; <span class="keyword">int</span> sum = <span class="number">0</span>;</div><div class="line">	f(j, <span class="number">1</span>, d) <span class="keyword">if</span>(x[a][j] &gt; x[b][j]) <span class="keyword">return</span> <span class="number">-1L</span>L;</div><div class="line">	<span class="keyword">else</span>&#123;</div><div class="line">		<span class="keyword">int</span> dx = x[b][j] - x[a][j];</div><div class="line">		sum += dx; ans = ans * invfac[dx] % MODLL;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ans * fac[sum] % MODLL;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">dp</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	LL &amp;ans = _dp[x];<span class="comment">//用取址符实现记忆化搜索 </span></div><div class="line">	<span class="keyword">if</span>(ans != <span class="number">-1L</span>L) <span class="keyword">return</span> ans;</div><div class="line">	ans = paths(<span class="number">0</span>, x);</div><div class="line">	f(i, <span class="number">1</span>, n + <span class="number">1</span>) <span class="keyword">if</span>(x != i)&#123;</div><div class="line">		LL cp = paths(i, x);</div><div class="line">		<span class="keyword">if</span>(cp != <span class="number">-1L</span>L) ans = (ans + MODLL - dp(i) * cp % MODLL) % MODLL;</div><div class="line">	&#125;</div><div class="line">	<span class="comment">// printf("dp %d = %I64d\n", x, ans);</span></div><div class="line">	<span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	fac[<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">	f(i, <span class="number">1</span>, <span class="number">10000008</span>) fac[i] = fac[i - <span class="number">1</span>] * (LL) i % MODLL;</div><div class="line">	invfac[<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">	f(i, <span class="number">1</span>, <span class="number">100008</span>) invfac[i] = invfac[i - <span class="number">1</span>] * inv(i) % MODLL;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;d,&amp;n);</div><div class="line">	f(j, <span class="number">1</span>, d) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, a + j);</div><div class="line">	f(i, <span class="number">1</span>, n) f(j, <span class="number">1</span>, d) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x[i][j]);</div><div class="line">	f(j, <span class="number">1</span>, d)&#123;</div><div class="line">		x[<span class="number">0</span>][j] = <span class="number">0</span>; x[n + <span class="number">1</span>][j] = a[j];</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">memset</span>(_dp, <span class="number">0xff</span>, <span class="keyword">sizeof</span>(_dp)); _dp[<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%I64d\n"</span>, dp(n + <span class="number">1</span>));</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></div></header></article><section class="reward"> <a class="btn-reward" href="#">加好友 or 打赏</a><div class="reward-wrapper clearfix"><img src="/img/QQ.jpg" title="QQ"><img src="/img/wechat.jpg" title="微信"></div></section><div class="comments" id="lv-container" data-id="city" data-uid="MTAyMC8yOTYwMy82MTcx"><script>(function(d, s) {var j, e = d.getElementsByTagName(s)[0];if (typeof LivereTower === 'function') { return; } j = d.createElement(s);j.src = 'https://cdn-city.livere.com/js/embed.dist.js';j.async = true;e.parentNode.insertBefore(j, e);})(document, 'script');</script></div></main><footer class="foot"><div class="foot-copy">&copy; 2017 by XLJ<a href="https://xianglujia.github.io/about/" target="view_window" style="color:#666;"> Welcome! </a></div></footer><script src="/js/scroller.js"></script><script src="/js/main.js"></script></body></html>